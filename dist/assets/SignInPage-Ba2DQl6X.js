import{u as D,g as z,f as G,r as l,j as e,L as x,a as P,e as v}from"./index-JHV42PaI.js";import{s as U,v as N}from"./sanatize-DUDiTChI.js";import{I as p}from"./InputField-DK3m_TmN.js";import{R as V,a as S}from"./RadioButton-D6ZtUwTp.js";import"./index-CrZBkDei.js";import"./eye-CmzZc3tr.js";const H=()=>{var w,y;const E=D(),O=z(),{login:k}=G(),[a,T]=l.useState(!0),[h,f]=l.useState(!1),[u,g]=l.useState(""),[t,b]=l.useState({emailPhone:"",password:""}),[d,r]=l.useState({}),[m,c]=l.useState(!1),I=((y=(w=O.state)==null?void 0:w.from)==null?void 0:y.pathname)||"/",j=s=>{const{name:o,value:i}=s.target;b(n=>({...n,[o]:U(i)})),r(n=>({...n,[o]:"",submit:""}))},C=s=>{T(s),f(!1),g(""),b({emailPhone:"",password:""}),r({})},F=()=>{const s={};return s.emailPhone=N(t.emailPhone,a),a&&(t.password?t.password.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required"),!a&&h&&(/^\d{6}$/.test(u)||(s.otp="OTP must be a 6-digit number")),Object.fromEntries(Object.entries(s).filter(([o,i])=>i))},L=async()=>{const s=N(t.emailPhone,!1);if(s){r({emailPhone:s});return}c(!0);try{await P(v.sendOtp,{method:"POST",body:{phone:t.emailPhone}}),f(!0),g("")}catch(o){r({submit:o.message||"Failed to send OTP. Please try again."})}finally{c(!1)}},R=async s=>{s.preventDefault();const o=F();if(Object.keys(o).length>0){r(o);return}c(!0),r({});try{const i=a?{email:t.emailPhone,password:t.password}:{phone:t.emailPhone,otp:u},n=await P(v.userLogin,{method:"POST",body:i});if(n.success&&n.data.user)k(n.data.user,n.data.token),E(I,{replace:!0});else throw new Error(n.message||"Login failed.")}catch(i){i.message.includes("Failed to fetch")?r({submit:"Cannot connect to server. Please check your connection or try again later."}):r({submit:i.message||"Invalid credentials. Please try again."})}finally{c(!1)}};return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-cover bg-center p-4 font-sans",style:{backgroundImage:"url('/img/auth-background.jpg')"},children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsx(x,{to:"/",children:e.jsx("img",{src:"/img/logo_shopzeo.png",alt:"Shopzeo Logo",className:"h-12 mx-auto"})})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"Welcome Back!"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sign in to continue"})]}),e.jsxs("form",{className:"space-y-6",onSubmit:R,children:[e.jsxs(V,{defaultValue:"email",onValueChange:s=>C(s==="email"),className:"flex justify-center space-x-6 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{value:"email",id:"r-email"}),e.jsx("label",{htmlFor:"r-email",children:"Email"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{value:"phone",id:"r-phone"}),e.jsx("label",{htmlFor:"r-phone",children:"Phone"})]})]}),e.jsx(p,{id:"emailPhone",name:"emailPhone",label:a?"Email":"Phone Number",type:a?"email":"tel",value:t.emailPhone,onChange:j,error:d.emailPhone,placeholder:a?"Enter your email here":"Enter your phone number here"}),a?e.jsx(p,{id:"password",name:"password",label:"Password",type:"password",value:t.password,onChange:j,error:d.password,placeholder:"Enter your password here"}):h?e.jsx(p,{id:"otp",name:"otp",label:"OTP",type:"text",value:u,onChange:s=>g(s.target.value),error:d.otp,placeholder:"Enter the 6-digit OTP here"}):null,!a&&!h&&e.jsx("button",{type:"button",onClick:L,disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400",children:m?"Sending OTP...":"Send OTP"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),e.jsx("div",{className:"text-sm",children:e.jsx(x,{to:"/forgot-password",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Forgot password?"})})]}),d.submit&&e.jsx("p",{className:"text-red-500 text-xs text-center",children:d.submit}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 transition-colors",children:m?"Signing In...":"Sign In"})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx(x,{to:"/signup",className:"font-semibold text-indigo-600 hover:underline",children:"Sign Up"})]})})]})]})})};export{H as default};
